#!/bin/bash

containers=$(sudo docker ps | awk '{if(NR>1) print $NF}')
host=$(hostname)

for container in $containers; do
  path="$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')"
  if [ "$path" == "" ]; then
    echo -e "\033[0mlib not found"
    continue
  fi

  if hexdump -ve '1/1 "%.2x"' "$path" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410; then
    echo -e "\e[1m\e[91mpotential vulnerable Version of xz in Docker Container $container"
  else
    echo -e "\033[0mDocker Container $container probably not vulnerable"
  fi

done
